# Neural Architecture Search
Проект включает инструменты для обработки данных и обучения модели на основе YOLO-NAS (Neural Architecture Search). Цель - эффективное детектирование самолетов и вертолетов в воздушном пространстве.

## Проблематика
Современные технологии активно развиваются, и беспилотные летательные аппараты становятся все более распространенными в различных сферах, включая гражданскую и промышленную. Это создает необходимость разработки эффективных систем для их обнаружения и распознавания, которые могли бы предотвратить угрозы гражданской и промышленной безопасности.

Участникам предлагается разработать прототип программно-аппаратного модуля в виде веб-сервиса, который с помощью нейронных сетей будет анализировать видеоинформацию с ТВ и ИК камер для обнаружения летательных аппаратов.

Будут метрика и лидерборд.

## Требования
- [<= Python 3.10](https://www.python.org/downloads/release/python-31015/)

## Установка
### 1. Клонируйте репозиторий
```sh
git clone https://github.com/Xpos587/nfd-yolov-2024.git
cd nfd-yolov-2024
```

### 2. Создайте и активируйте виртуальное окружение
```sh
python -m venv venv
source venv/bin/activate  # Для Linux/MacOS
venv\Scripts\activate  # Для Windows
```

### 3. Установите зависимости
```sh
pip install -r requirements.txt
```

## Подготовка данных
### 1. Структура данных
Данные должны быть организованы в следующей структуре:
```sh
data/public/
├── train/
│   ├── images/
│   └── labels/
├── valid/
│   ├── images/
│   └── labels/
└── test/
    ├── images/
    └── labels/
```

### 2. Формат меток
Метки должны быть в формате YOLO: `class_id x_center y_center width height`.

## Обучение модели
### 1. Запустите обучение

```sh
python -m src.model --train --data-dir ./data/public --epochs 100 --batch-size 16 --lr 0.001 --num-classes 2
```

### 2. Основные параметры обучения
- `--data-dir`: Путь к директории с данными.
- `--epochs`: Количество эпох обучения.
- `--batch-size`: Размер батча.
- `--lr`: Начальная скорость обучения.
- `--num-classes`: Количество классов для детекции.

## Оценка модели
### 1. Запустите оценку модели
```sh
python -m src.model --evaluate --data-dir ./data/public --num-classes 2 --model-path models/trained_aircraft_detection_model.pth
```

### 2. Основные параметры оценки
- `--data-dir`: Путь к директории с тестовыми данными.
- `--num-classes`: Количество классов для детекции.
- `--model-path`: Путь к сохраненной модели.

## Использование модели для предсказаний
### 1. Запустите предсказания на новых данных
Для выполнения предсказаний на видеофайле используйте следующий скрипт:

```sh
python -m src.predict --video-path path/to/video.mp4 --output-dir ./output --model-path models/trained_aircraft_detection_model.pth --num-classes 2
```

### 2. Основные параметры для предсказаний

- `--video-path`: Путь к видеофайлу, на котором необходимо выполнить детекцию.
- `--output-dir`: Директория для сохранения результатов (например, обработанных видео или изображений).
- `--model-path`: Путь к сохраненной обученной модели, которую вы хотите использовать для предсказаний.
- `--num-classes`: Количество классов для детекции (например, 2 для самолетов и вертолетов).

### Пример использования

1. Убедитесь, что у вас есть обученная модель, сохраненная в `models/trained_aircraft_detection_model.pth`.

2. Запустите предсказания на видео:

```sh
python -m src.predict --video-path ./data/videos/sample_video.mp4 --output-dir ./output --model-path models/trained_aircraft_detection_model.pth --num-classes 2
```

3. Результаты будут сохранены в директории `./output`.

### Примечание

Убедитесь, что все необходимые библиотеки установлены и настроены правильно перед запуском скрипта предсказаний.
